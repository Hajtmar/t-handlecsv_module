\usemodule[handlecsv]


\startbuffer[action]
\numline\ -- \lineno -- \Lastname\ \Firstname, \Email\crlf
\stopbuffer

\setheader
\setsep{,}




\starttext
\opencsvfile{lide.csv}

%\resetnumline
%\resetlinepointer


\doloopfornext{3}{\getbuffer[action]}



+++

\doloopfornext{3}{\getbuffer[action]}

+++

\setlinepointer{15}

\setnumline{110}

\doloopfornext{4}{\getbuffer[action]}

+++

\doloopfornext{-5}{\getbuffer[action]}

+++

\resetnumline
\setlinepointer{20}
\doloopfornext{-100}{\getbuffer[action]}


\stoptext



% 6. \doloopfornext{<number>}{<action>}
% do action <action> for next <number> of rows from current line of open CSV file  --- thirddata.handlecsv.gCurrentLinePointer, \linepointer
\def\doloopfornext#1#2{\ctxlua{thirddata.handlecsv.doloopfromto(thirddata.handlecsv.gCurrentLinePointer,[==[\thenumexpr{\linepointer+#1-1}]==],[==[\detokenize{#2}]==])}}%
